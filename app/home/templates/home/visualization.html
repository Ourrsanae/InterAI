{% extends "layout.html" %}
{% block content %}
<h1 class="text-center">Choose Your Plot</h1>
<form action="/visualization" method="POST">
    <div class="row mt-5">
        <div class="card m-auto" style="width: 90%;" data-aos="fade-left">
            <div class="card-body">
                <div class="mb-3">
                    <label for="plot_type">Choose Plot Type:</label>
                    <select name="plot_type" id="plot_type">
                        <option value="bar">Bar</option>
                        <option value="scatter_3d">3D Scatter</option>
                        <option value="line">Line</option>
                    </select>
                </div>
                <label for="x_axis">Choose X-Axis:</label>
                <select name="x_axis" id="x_axis">
                    <option></option>
                    {% for col in columns %}
                        <option value="{{ col }}">{{ col }}</option>
                    {% endfor %}
                </select>

                <label for="y_axis">Choose Y-Axis:</label>
                <select name="y_axis" id="y_axis">
                    <option></option>
                    {% for col in columns %}
                        <option value="{{ col }}">{{ col }}</option>
                    {% endfor %}
                </select>

                <label for="z_axis">Choose Z-Axis (for 3D Scatter only):</label>
                <select name="z_axis" id="z_axis">
                    <option value=""></option>
                    {% for col in columns %}
                        <option value="{{ col }}">{{ col }}</option>
                    {% endfor %}
                </select>
                <div class="text-end mt-2">
                    <button type="submit" class="btn btn-primary">Generate Plot</button>
                </div>
            </div>
        </div>
    </div>
</form>

{% if graphJSON %}
<div class="row mt-5">
    <div class="card m-auto" style="width: 90%;" data-aos="fade-left">
        <div class="card-body">
            <div id="plotly-graph" style="width: 100%; height: 100%;">
                <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
                <div id="graph" style="width: 100%; height: 100%;"></div>
                <script>
                    var graphJSON = {{ graphJSON|safe }};
                    Plotly.newPlot('graph', graphJSON.data, graphJSON.layout);
                </script>
            </div>
            {% if summary %}
            <div class="mt-5">
                <div class="interpretation">
                    <p>{{ summary|safe }}</p>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endif %}
{% endblock %}
